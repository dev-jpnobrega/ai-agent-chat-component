{"file":"chat-component.entry.esm.js","mappings":"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","names":[],"sources":["src/utils/fetch-request.ts","src/service/ai-enterprise.service.ts","src/utils/translation.ts","src/components/chat-component/chat-component.scss?tag=chat-component&encapsulation=shadow","src/components/chat-component/chat-component.tsx"],"sourcesContent":["class FetchRequestError extends Error {\n  code: any;\n  originalStack: any;\n\n  constructor(originalError) {\n    const detailedError = originalError.cause\n      ? originalError.cause\n      : originalError;\n\n    let { message, code } = detailedError;\n\n    if (originalError.name === 'AbortError') {\n      message = 'Request timeout';\n      code = 'ETIMEDOUT';\n    }\n\n    super(message);\n\n    this.name = detailedError.name;\n    this.code = code;\n    this.originalStack = detailedError.stack;\n  }\n}\n\nfunction configureTimeout({ timeout, abortController = new AbortController() }) {\n  let timeoutId = null;\n  const { signal } = abortController;\n\n  if (timeout) {\n    timeoutId = setTimeout(() => {\n      abortController.abort();\n    }, timeout);\n  }\n\n  return { signal, timeoutId };\n}\n\n\nfunction tryParseJSON(value) {\n  try {\n    return JSON.parse(value);\n  } catch (error) {\n    return value;\n  }\n};\n\n\n/* eslint-disable-next-line max-lines-per-function */\nasync function formatResponse(response, returnStream) {\n  const body = returnStream\n    ? response.body\n    : tryParseJSON(await response.text());\n\n  const responseHeaders = {};\n\n  Array.from(response.headers.keys()).forEach((key: any) => {\n    responseHeaders[key] = response.headers.get(key);\n  });\n\n  const formattedResponse = {\n    body,\n    response: {\n      body,\n      headers: responseHeaders,\n      ok: response.ok,\n      statusCode: response.status,\n      statusText: response.statusText,\n    },\n  };\n\n  return response.ok\n    ? formattedResponse\n    : Promise.reject(formattedResponse);\n}\n\n/**\n * Sends a fetch request.\n *\n * @param {Object} options - The options for the fetch request.\n * @param {string} options.uri - The URI to request.\n * @param {Object} options.headers - The headers to include in the request.\n * @param {Object} options.body - The body of the request.\n * @param {Object} options.params - The query parameters to include in the request.\n * @param {boolean} returnStream - Whether to return the response body as a stream.\n * @returns {Promise<Object>} The response from the fetch request.\n *\n * @throws {Promise<Object>} If the fetch request fails, it throws a Promise\n *  that rejects with the response of a instance of FetchRequestError.\n */\n/* eslint-disable-next-line max-lines-per-function, max-statements */\nexport default async function fetchRequest(\n  options = {} as any,\n  returnStream = false,\n) {\n  try {\n    const abortSignal = configureTimeout(options);\n\n    const reqHeaders = {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    };\n\n    const uri = new URL(options.uri);\n\n    const { params = {} } = options;\n\n    Object.keys(params).forEach((key) => {\n      uri.searchParams.append(key, params[key]);\n    });\n\n    const response = await fetch(uri, {\n      ...options,\n      body: JSON.stringify(options.body),\n      headers: reqHeaders,\n      signal: abortSignal.signal,\n    });\n\n    clearTimeout(abortSignal.timeoutId);\n\n    return formatResponse(response, returnStream);\n  } catch (error) {\n    const fetchRequestError = new FetchRequestError(error);\n\n    console.error({\n      details: fetchRequestError,\n      error: fetchRequestError.name,\n      message: `[COMMONS-FETCH-REQUEST]-ERROR: ${fetchRequestError.name} - ${fetchRequestError.message}`,\n    });\n\n    throw fetchRequestError;\n  }\n};\n","import fetchRequest from '../utils/fetch-request';\n\ninterface SettingsService {\n\turl: string;\n\tkey: string;\n}\n\nclass AIEnterpriseService {\n\tsettings: SettingsService;\n\n\tconstructor(settings: SettingsService) {\n\t\tthis.settings = settings;\n\t}\n\n\tasync send(message: { content: string }, chatUid: string, agentUid: string): Promise<string> {\n\t\ttry {\n\t\t\tconst result = await fetchRequest({\n\t\t\t\tmethod: `POST`,\n\t\t\t\turi: `${this.settings.url}/workout/v1/chat`,\n\t\t\t\tbody: {\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tid: chatUid,\n\t\t\t\t\t\tagentUid: agentUid,\n\t\t\t\t\t\tuserId: 'currentUser',\n\t\t\t\t\t\tmessages: [message],\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn result.body;\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t}\n\t}\n}\n\nexport default AIEnterpriseService;","class TranslationUtils {\n\tstatic async fetchTranslations(lang: string = `en`): Promise<any> {\n\t\tconst existingTranslations = JSON.parse(sessionStorage.getItem(`i18n.${lang}`));\n\n\t\tif (existingTranslations && Object.keys(existingTranslations).length > 0) {\n\t\t\treturn existingTranslations;\n\t\t}\n\n\t\ttry {\n\t\t\tconst response = await fetch(`/assets/translate/${lang}.json`);\n\n\t\t\tif (response.ok) {\n\t\t\t\tconst data = await response.json();\n\t\t\t\tsessionStorage.setItem(`i18n.${lang}`, JSON.stringify(data));\n\t\t\t\treturn data;\n\t\t\t}\n\t\t} catch (exception) {\n\t\t\tconsole.error(`Error loading locale: ${lang}`, exception);\n\n      return undefined;\n\t\t}\n\t}\n}\n\nexport default TranslationUtils;","/*--------------------\nMixins\n--------------------*/\n@mixin center {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n\n@mixin ball {\n  @include center;\n  content: '';\n  display: block;\n  width: 3px;\n  height: 3px;\n  border-radius: 50%;\n  background: rgba(0, 0, 0, 0.5);\n  z-index: 2;\n  margin-top: 4px;\n  animation: ball .45s cubic-bezier(0, 0, 0.15, 1) alternate infinite;\n}\n\n\n/*--------------------\nBody\n--------------------*/\n*,\n*::before,\n*::after {\n  box-sizing: border-box;\n}\n\nhtml, body {\n  height: 100%;\n  margin: 0;\n}\n\nbody {\n  background: linear-gradient(135deg, #044f48, #2a7561);\n  background-size: cover;\n  font-family:  'Segoe UI, Helvetica Neue, Helvetica, Lucida Grande, Arial, Ubuntu, Cantarell, Fira Sans', sans-serif;\n  font-size: 12px;\n  line-height: 1.3;\n  overflow: hidden;\n}\n\n.bg {\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  z-index: 1;\n  filter: blur(80px);\n  transform: scale(1.2);\n}\n\n\n/*--------------------\nChat\n--------------------*/\n.chat {\n  font-family:  'Segoe UI, Helvetica Neue, Helvetica, Lucida Grande, Arial, Ubuntu, Cantarell, Fira Sans', sans-serif;\n  @include center;\n  min-height: 100%;\n  min-width: 100%;\n  overflow: hidden;\n  box-shadow: 0 5px 30px rgba(0, 0, 0, .2);\n  background: url('https://cloudfronttestebucket.s3.amazonaws.com/bg.png') repeat 0 0;\n  border-radius: 20px;\n  display: flex;\n  justify-content: space-between;\n  flex-direction: column;\n}\n\n\n/*--------------------\nChat Title\n--------------------*/\n.chat-title {\n  flex: 0 1 45px;\n  position: relative;\n  z-index: 2;\n  background: #F0F2F5;\n  color: #000;\n  text-align: left;\n  padding: 10px 10px 10px 50px;\n  \n  h1, h2 {\n    font-weight: normal;\n    font-size: 10px;\n    margin: 0;\n    padding: 1px;\n  }\n  \n  h2 {\n    color: rgb(99, 95, 95);\n    font-size: 8px;\n    margin-top: 1px;\n  }\n  \n  .avatar {\n    position: absolute;\n    z-index: 1;\n    top: 8px;\n    left: 9px;\n    border-radius: 30px;\n    width: 30px;\n    height: 30px;\n    overflow: hidden;\n    margin: 0;\n    padding: 0;\n    border: 2px solid rgba(255, 255, 255, 0.24);\n    \n    img {\n      width: 100%;\n      height: 100%;\n    }\n  }\n}\n\n\n/*--------------------\nMessages\n--------------------*/\n.messages {\n  flex: 1 1 auto;\n  overflow: auto;\n  position: relative;\n  width: 100%;\n  \n  & .messages-content {\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 101%;\n    width: 100%;\n  }\n\n  \n  .message {\n    clear: both;\n    float: left;\n    padding: 6px 10px 7px;\n    border-radius: 10px 10px 10px 0;\n    background: rgb(255, 255, 255);\n    margin: 8px 0;\n    font-size: 11px;\n    line-height: 1.4;\n    margin-left: 35px;\n    position: relative;\n    \n    .timestamp {\n      float: right;\n      align-content: end;\n      bottom: -15px;\n      font-size: 9px;\n      z-index: 3;\n      color: rgba(2, 2, 2, 0.3);\n    }\n    \n    &::before {\n      content: '';\n      position: absolute;\n      bottom: -6px;\n      border-top: 6px solid rgb(255, 255, 255);\n      left: 0;\n      border-right: 7px solid transparent;\n    }\n    \n    .avatar {\n      position: absolute;\n      z-index: 1;\n      bottom: -15px;\n      left: -35px;\n      border-radius: 30px;\n      width: 30px;\n      height: 30px;\n      overflow: hidden;\n      margin: 0;\n      padding: 0;\n\n      img {\n        width: 100%;\n        height: 90%;\n      }\n    }\n    \n    &.message-personal {\n      float: right;\n      text-align: right;\n      background: linear-gradient(120deg, #E1F6CA, #E1F6CA);\n      border-radius: 10px 10px 0 10px;\n      \n      &::before {\n        left: auto;\n        right: 0;\n        border-right: none;\n        border-left: 5px solid transparent;\n        border-top: 4px solid #E1F6CA;\n        bottom: -4px;\n      }\n    }\n    \n    &:last-child {\n      margin-bottom: 30px;\n    }\n    \n    &.new {\n      transform: scale(0);\n      transform-origin: 0 0;\n      animation: bounce 500ms linear both;\n    }\n    \n    &.loading {\n\n      &::before {\n        @include ball;\n        border: none;\n        animation-delay: .15s;\n      }\n\n      & span {\n        display: block;\n        font-size: 0;\n        width: 20px;\n        height: 10px;\n        position: relative;\n\n        &::before {\n          @include ball;\n          margin-left: -7px;\n        }\n\n        &::after {\n          @include ball;\n          margin-left: 7px;\n          animation-delay: .3s;\n        }\n      }\n    }\n    \n  }\n}\n\n\n/*--------------------\nMessage Box\n--------------------*/\n.message-box {\n  flex: 0 1 40px;\n  width: 100%;\n  background: #F0F2F5;\n  padding: 10px;\n  position: relative;\n  \n  & .message-input {\n    background: none;\n    border: none;\n    outline: none!important;\n    resize: none;\n    color: rgb(12, 12, 12);\n    font-size: 11px;\n    height: 17px;\n    margin: 0;\n    padding-right: 20px;\n    width: 265px;\n  }\n  \n  textarea:focus:-webkit-placeholder{\n      color: transparent;\n  }\n  \n  & .message-submit {\n    position: absolute;\n    z-index: 1;\n    top: 9px;\n    right: 10px;\n    color: #fff;\n    border: none;\n    background: #248A52;\n    font-size: 10px;\n    text-transform: uppercase;\n    line-height: 1;\n    padding: 6px 10px; \n    border-radius: 10px;\n    outline: none!important;\n    transition: background .2s ease;\n    \n    &:hover {\n      background: #1D7745;\n    }\n  }\n\n  & .message-submit:disabled {\n    position: absolute;\n    z-index: 1;\n    top: 9px;\n    right: 10px;\n    color: #fff;\n    border: none;\n    background: #CCCCCC;\n    font-size: 10px;\n    text-transform: uppercase;\n    line-height: 1;\n    padding: 6px 10px; \n    border-radius: 10px;\n  }\n}\n\n\n/*--------------------\nCustom Srollbar\n--------------------*/\n/* width */\n::-webkit-scrollbar {\n  width: 0.3em;\n  opacity: 0;\n}\n\n/* Track */\n::-webkit-scrollbar-track {\n  box-shadow: inset 0 0 5px #F0F2F5; \n  opacity: 0;\n}\n \n/* Handle */\n::-webkit-scrollbar-thumb {\n  background-color: rgba(192, 185, 185, 0.5)!important;\n  opacity: 0;\n}\n\n/* Handle on hover */\n::-webkit-scrollbar-thumb:hover {\n  background-color: rgba(192, 185, 185, 0.5)!important;\n  margin: 1px -3px 1px 0;\n  opacity: 0;\n}\n\n.mCSB_scrollTools {\n  margin: 1px -3px 1px 0;\n  opacity: 0;\n}\n\n.mCSB_inside > .mCSB_container {\n  margin-right: 0px;\n  padding: 0 10px;\n}\n\n.mCSB_scrollTools .mCSB_dragger .mCSB_dragger_bar {\n  background-color: rgba(192, 185, 185, 0.5)!important;\n}\n\n\n/*--------------------\nBounce\n--------------------*/\n@keyframes bounce { \n  0% { transform: matrix3d(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  4.7% { transform: matrix3d(0.45, 0, 0, 0, 0, 0.45, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  9.41% { transform: matrix3d(0.883, 0, 0, 0, 0, 0.883, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  14.11% { transform: matrix3d(1.141, 0, 0, 0, 0, 1.141, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  18.72% { transform: matrix3d(1.212, 0, 0, 0, 0, 1.212, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  24.32% { transform: matrix3d(1.151, 0, 0, 0, 0, 1.151, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  29.93% { transform: matrix3d(1.048, 0, 0, 0, 0, 1.048, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  35.54% { transform: matrix3d(0.979, 0, 0, 0, 0, 0.979, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  41.04% { transform: matrix3d(0.961, 0, 0, 0, 0, 0.961, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  52.15% { transform: matrix3d(0.991, 0, 0, 0, 0, 0.991, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  63.26% { transform: matrix3d(1.007, 0, 0, 0, 0, 1.007, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  85.49% { transform: matrix3d(0.999, 0, 0, 0, 0, 0.999, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  100% { transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); } \n}\n\n\n@keyframes ball { \n  from {\n    transform: translateY(0) scaleY(.8);\n  }\n  to {\n    transform: translateY(-10px);\n  }\n}\n","import { Event, Component, FunctionalComponent, Prop, h, EventEmitter, Listen, State } from '@stencil/core';\nimport AIEnterpriseService from '../../service/ai-enterprise.service';\nimport TranslationUtils from '../../utils/translation';\n\ninterface MessagesProps {\n  messages: Message[];\n}\n\ninterface Message {\n  id?: string;\n  content?: string;\n  date: Date;\n  sender: `AI` | `USER`;\n  loading: boolean;\n}\n\nconst Message: FunctionalComponent<Message> = ({ content, date, sender, loading }) => { \n  const dateFormart = date.getHours() + ':' + date.getMinutes();\n\n  const MessageUser = (message: Message) => {\n    return (\n      <div class=\"message message-personal new\">\n        <div innerHTML={ message.content?.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>') || '' }><span/></div>\n        <div class=\"timestamp\">{dateFormart}</div>\n      </div>\n    )\n  }\n\n  const MessageAI = (message: Message) => {\n    return (\n      <div class={`message ${!message.loading || `loading`} new`}>\n        <figure class=\"avatar\">\n          <img src=\"https://cloudfronttestebucket.s3.amazonaws.com/agent.jpg\" />\n        </figure>\n        <div innerHTML={ message.content?.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>') || '' }><span/></div>\n        <div class=\"timestamp\">{dateFormart}</div>\n      </div>\n    )\n  }\n\n  return sender === `AI` ? \n    MessageAI({ content, date, sender, loading }) : \n    MessageUser({ content, date, sender, loading });\n};\n\nconst Messages: FunctionalComponent<MessagesProps> = ({ messages }) => { \n  return (\n    <div class='messages-content'>\n      { messages.map((message) => (\n        <Message \n          content={message.content} \n          date={message.date} \n          sender={message.sender} \n          loading={message.loading} />\n      ))}\n    </div>\n  )\n};\n\n\nconst service = new AIEnterpriseService({\n  url: 'https://ai-enterprise-api.azurewebsites.net',\n  key: 'my-key',\n});\n\n@Component({\n  tag: 'chat-component',\n  styleUrl: 'chat-component.scss',\n  shadow: true,\n})\nexport class ChatComponent {\n  /**\n   * The greetings\n   */\n  @Prop() greetings: string;\n\n  /**\n   * The Agent identifier\n   */\n  @Prop() identifier: string;\n\n  /**\n   * The Chat identifier\n   */\n  @Prop() chatUid?: string;\n\n  /**\n   * The language\n   */\n  @Prop() language?: string;\n  \n  @Event() send: EventEmitter;\n  @Event() receiver: EventEmitter;\n\n  @State() translations: any;\n  @State() messages: Message[] = [];\n  @State() content: string = '';\n  @State() disableSend: boolean = true;\n\n  async componentWillLoad() {\n    const messageID = Math.random().toString(36).substring(7);\n\n    this.translations = await TranslationUtils.fetchTranslations(this.language);\n\n    this.receiver.emit({\n      id: messageID,\n      content: undefined,\n      date: new Date(),\n      loading: true,\n      sender: 'AI'\n    });\n\n    service.send({ content: this.greetings || 'Hi' }, this.chatUid || '1', this.identifier)\n      .then((response) => {\n        this.receiver.emit({\n          id: messageID,\n          content: response,\n          date: new Date(),\n          loading: false,\n          sender: 'AI'\n        });\n\n        this.disableSend = false;\n      })\n      .catch((error) => {\n        console.error(error);\n      });\n  }\n\n  componentDidRender() {\n    this.onScroll(null);\n  }\n\n  @Listen('send')\n  sendHandler(event: CustomEvent<Message>) {\n    const message = event.detail as any;\n    \n    this.disableSend = true;\n\n    this.receiver.emit({\n      ...message,\n    });\n\n    const messageID = Math.random().toString(36).substring(7);\n\n    this.receiver.emit({\n      id: messageID,\n      date: new Date(),\n      loading: true,\n      sender: 'AI'\n    });\n  \n    service.send(message, this.chatUid || '1', this.identifier)\n      .then((response) => {\n        this.receiver.emit({\n          id: messageID,\n          content: response,\n          date: new Date(),\n          loading: false,\n          sender: 'AI'\n        });\n\n        this.disableSend = false;\n      })\n      .catch((error) => {\n        console.error(error);\n      });\n  }\n\n  @Listen('receiver')\n  receiverHandler(event: CustomEvent<Message>) {\n    const message = event.detail;\n\n    this.messages = [\n      ...this.messages.filter(item => item.id !== message.id), \n      message,\n    ];\n  }\n\n  @Listen('keydown')\n  handleKeyDown(ev: KeyboardEvent){\n    if (ev.key === 'Enter' && !this.disableSend){\n      this.handleSend(ev);\n    }\n  }\n\n  handleSend(event: Event) {\n    event.preventDefault();\n\n    if (!this.content) return;\n\n    this.send.emit({\n      id: Math.random().toString(36).substring(7),\n      content: this.content,\n      date: new Date(),\n      loading: false,\n      sender: 'USER'\n    });\n\n    this.content = '';\n  }\n\n  handleChange(event: Event) { \n    this.content = (event.target as HTMLInputElement).value;    \n  }\n\n  renderMessages = (messages: Message[]) => {\n    return (\n      <Messages messages={messages} />\n    )\n  }\n\n  private messagesContainer: HTMLDivElement = null;\n  \n  onScroll(_e) {\n    if (this.messagesContainer) {\n      this.messagesContainer.scrollTo({\n        top: this.messagesContainer.scrollHeight,\n        behavior: 'smooth'\n      });\n    }\n  }\n\n  render() {\n    return (\n      <div class='chat'>\n        <div class='chat-title'>\n          <h1>BOT Lua</h1>\n          <h2>Atendimento Global</h2>\n          <figure class='avatar'>\n            <img src='https://cloudfronttestebucket.s3.amazonaws.com/agent.jpg' />\n          </figure>\n        </div>\n        <div class='messages' ref={ el => this.messagesContainer = el }>\n          { this.renderMessages(this.messages) }\n        </div>\n        <div class='message-box'>\n          <textarea\n            typeof='text'\n            value={ this.content }\n            onInput={ (event) => this.handleChange(event) } \n            class='message-input' \n            placeholder={ (this.translations) ? this.translations['text?.placeholder'] : 'Digite sua mensagem ...' }>\n          </textarea>\n          <button disabled={this.disableSend} type='submit' class='message-submit' onClick={ (e) => this.handleSend(e) }>\n            { (this.translations) ? this.translations['button?.send'] : 'Enviar' }\n          </button>\n        </div>\n      </div>\n    )\n  }\n}\n"],"version":3}
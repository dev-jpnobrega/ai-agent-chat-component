{"version":3,"names":["FetchRequestError","Error","constructor","originalError","detailedError","cause","message","code","name","super","this","originalStack","stack","configureTimeout","timeout","abortController","AbortController","timeoutId","signal","setTimeout","abort","tryParseJSON","value","JSON","parse","error","async","formatResponse","response","returnStream","body","text","responseHeaders","Array","from","headers","keys","forEach","key","get","formattedResponse","ok","statusCode","status","statusText","Promise","reject","fetchRequest","options","abortSignal","reqHeaders","Object","assign","uri","URL","params","searchParams","append","fetch","stringify","clearTimeout","fetchRequestError","console","details","AIEnterpriseService","settings","send","chatUid","agentUid","result","method","url","id","userId","messages","TranslationUtils","fetchTranslations","lang","existingTranslations","sessionStorage","getItem","length","data","json","setItem","exception","chatComponentCss","ChatComponentStyle0","Message","content","date","sender","loading","dateFormart","getHours","getMinutes","MessageUser","h","class","innerHTML","_a","replace","MessageAI","src","Messages","map","service","ChatComponent","renderMessages","messagesContainer","componentWillLoad","messageID","Math","random","toString","substring","translations","language","receiver","emit","undefined","Date","greetings","identifier","then","disableSend","catch","componentDidRender","onScroll","sendHandler","event","detail","receiverHandler","filter","item","handleKeyDown","ev","handleSend","preventDefault","handleChange","target","_e","scrollTo","top","scrollHeight","behavior","render","ref","el","typeof","onInput","placeholder","disabled","type","onClick","e"],"sources":["src/utils/fetch-request.ts","src/service/ai-enterprise.service.ts","src/utils/translation.ts","src/components/chat-component/chat-component.scss?tag=chat-component&encapsulation=shadow","src/components/chat-component/chat-component.tsx"],"sourcesContent":["class FetchRequestError extends Error {\n  code: any;\n  originalStack: any;\n\n  constructor(originalError) {\n    const detailedError = originalError.cause\n      ? originalError.cause\n      : originalError;\n\n    let { message, code } = detailedError;\n\n    if (originalError.name === 'AbortError') {\n      message = 'Request timeout';\n      code = 'ETIMEDOUT';\n    }\n\n    super(message);\n\n    this.name = detailedError.name;\n    this.code = code;\n    this.originalStack = detailedError.stack;\n  }\n}\n\nfunction configureTimeout({ timeout, abortController = new AbortController() }) {\n  let timeoutId = null;\n  const { signal } = abortController;\n\n  if (timeout) {\n    timeoutId = setTimeout(() => {\n      abortController.abort();\n    }, timeout);\n  }\n\n  return { signal, timeoutId };\n}\n\n\nfunction tryParseJSON(value) {\n  try {\n    return JSON.parse(value);\n  } catch (error) {\n    return value;\n  }\n};\n\n\n/* eslint-disable-next-line max-lines-per-function */\nasync function formatResponse(response, returnStream) {\n  const body = returnStream\n    ? response.body\n    : tryParseJSON(await response.text());\n\n  const responseHeaders = {};\n\n  Array.from(response.headers.keys()).forEach((key: any) => {\n    responseHeaders[key] = response.headers.get(key);\n  });\n\n  const formattedResponse = {\n    body,\n    response: {\n      body,\n      headers: responseHeaders,\n      ok: response.ok,\n      statusCode: response.status,\n      statusText: response.statusText,\n    },\n  };\n\n  return response.ok\n    ? formattedResponse\n    : Promise.reject(formattedResponse);\n}\n\n/**\n * Sends a fetch request.\n *\n * @param {Object} options - The options for the fetch request.\n * @param {string} options.uri - The URI to request.\n * @param {Object} options.headers - The headers to include in the request.\n * @param {Object} options.body - The body of the request.\n * @param {Object} options.params - The query parameters to include in the request.\n * @param {boolean} returnStream - Whether to return the response body as a stream.\n * @returns {Promise<Object>} The response from the fetch request.\n *\n * @throws {Promise<Object>} If the fetch request fails, it throws a Promise\n *  that rejects with the response of a instance of FetchRequestError.\n */\n/* eslint-disable-next-line max-lines-per-function, max-statements */\nexport default async function fetchRequest(\n  options = {} as any,\n  returnStream = false,\n) {\n  try {\n    const abortSignal = configureTimeout(options);\n\n    const reqHeaders = {\n      'Content-Type': 'application/json',\n      ...options.headers,\n    };\n\n    const uri = new URL(options.uri);\n\n    const { params = {} } = options;\n\n    Object.keys(params).forEach((key) => {\n      uri.searchParams.append(key, params[key]);\n    });\n\n    const response = await fetch(uri, {\n      ...options,\n      body: JSON.stringify(options.body),\n      headers: reqHeaders,\n      signal: abortSignal.signal,\n    });\n\n    clearTimeout(abortSignal.timeoutId);\n\n    return formatResponse(response, returnStream);\n  } catch (error) {\n    const fetchRequestError = new FetchRequestError(error);\n\n    console.error({\n      details: fetchRequestError,\n      error: fetchRequestError.name,\n      message: `[COMMONS-FETCH-REQUEST]-ERROR: ${fetchRequestError.name} - ${fetchRequestError.message}`,\n    });\n\n    throw fetchRequestError;\n  }\n};\n","import fetchRequest from '../utils/fetch-request';\n\ninterface SettingsService {\n\turl: string;\n\tkey: string;\n}\n\nclass AIEnterpriseService {\n\tsettings: SettingsService;\n\n\tconstructor(settings: SettingsService) {\n\t\tthis.settings = settings;\n\t}\n\n\tasync send(message: { content: string }, chatUid: string, agentUid: string): Promise<string> {\n\t\ttry {\n\t\t\tconst result = await fetchRequest({\n\t\t\t\tmethod: `POST`,\n\t\t\t\turi: `${this.settings.url}/workout/v1/chat`,\n\t\t\t\tbody: {\n\t\t\t\t\tbody: {\n\t\t\t\t\t\tid: chatUid,\n\t\t\t\t\t\tagentUid: agentUid,\n\t\t\t\t\t\tuserId: 'currentUser',\n\t\t\t\t\t\tmessages: [message],\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn result.body;\n\t\t} catch (error) {\n\t\t\tconsole.error(error);\n\t\t}\n\t}\n}\n\nexport default AIEnterpriseService;","class TranslationUtils {\n\tstatic async fetchTranslations(lang: string = `en`): Promise<any> {\n\t\tconst existingTranslations = JSON.parse(sessionStorage.getItem(`i18n.${lang}`));\n\n\t\tif (existingTranslations && Object.keys(existingTranslations).length > 0) {\n\t\t\treturn existingTranslations;\n\t\t}\n\n\t\ttry {\n\t\t\tconst response = await fetch(`/assets/translate/${lang}.json`);\n\n\t\t\tif (response.ok) {\n\t\t\t\tconst data = await response.json();\n\t\t\t\tsessionStorage.setItem(`i18n.${lang}`, JSON.stringify(data));\n\t\t\t\treturn data;\n\t\t\t}\n\t\t} catch (exception) {\n\t\t\tconsole.error(`Error loading locale: ${lang}`, exception);\n\t\t}\n\t}\n}\n\nexport default TranslationUtils;","/*--------------------\nMixins\n--------------------*/\n@mixin center {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n}\n\n@mixin ball {\n  @include center;\n  content: '';\n  display: block;\n  width: 3px;\n  height: 3px;\n  border-radius: 50%;\n  background: rgba(0, 0, 0, 0.5);\n  z-index: 2;\n  margin-top: 4px;\n  animation: ball .45s cubic-bezier(0, 0, 0.15, 1) alternate infinite;\n}\n\n\n/*--------------------\nBody\n--------------------*/\n*,\n*::before,\n*::after {\n  box-sizing: border-box;\n}\n\nhtml,\nbody {\n  height: 100%;\n}\n\nbody {\n  background: linear-gradient(135deg, #044f48, #2a7561);\n  background-size: cover;\n  font-family:  'Segoe UI, Helvetica Neue, Helvetica, Lucida Grande, Arial, Ubuntu, Cantarell, Fira Sans', sans-serif;\n  font-size: 12px;\n  line-height: 1.3;\n  overflow: hidden;\n}\n\n.bg {\n  width: 100%;\n  height: 100%;\n  top: 0;\n  left: 0;\n  z-index: 1;\n  filter: blur(80px);\n  transform: scale(1.2);\n}\n\n\n/*--------------------\nChat\n--------------------*/\n.chat {\n  font-family:  'Segoe UI, Helvetica Neue, Helvetica, Lucida Grande, Arial, Ubuntu, Cantarell, Fira Sans', sans-serif;\n  @include center;\n  width: 300px;\n  height: 80vh;\n  max-height: 500px;\n  overflow: hidden;\n  box-shadow: 0 5px 30px rgba(0, 0, 0, .2);\n  background: url('https://cloudfronttestebucket.s3.amazonaws.com/bg.png') no-repeat 0 0;\n  border-radius: 20px;\n  display: flex;\n  justify-content: space-between;\n  flex-direction: column;\n}\n\n\n/*--------------------\nChat Title\n--------------------*/\n.chat-title {\n  flex: 0 1 45px;\n  position: relative;\n  z-index: 2;\n  background: #F0F2F5;\n  color: #000;\n  text-align: left;\n  padding: 10px 10px 10px 50px;\n  \n  h1, h2 {\n    font-weight: normal;\n    font-size: 10px;\n    margin: 0;\n    padding: 1px;\n  }\n  \n  h2 {\n    color: rgb(99, 95, 95);\n    font-size: 8px;\n    margin-top: 1px;\n  }\n  \n  .avatar {\n    position: absolute;\n    z-index: 1;\n    top: 8px;\n    left: 9px;\n    border-radius: 30px;\n    width: 30px;\n    height: 30px;\n    overflow: hidden;\n    margin: 0;\n    padding: 0;\n    border: 2px solid rgba(255, 255, 255, 0.24);\n    \n    img {\n      width: 100%;\n      height: 100%;\n    }\n  }\n}\n\n\n/*--------------------\nMessages\n--------------------*/\n.messages {\n  flex: 1 1 auto;\n  overflow: auto;\n  position: relative;\n  width: 100%;\n  \n  & .messages-content {\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 101%;\n    width: 100%;\n  }\n\n  \n  .message {\n    clear: both;\n    float: left;\n    padding: 6px 10px 7px;\n    border-radius: 10px 10px 10px 0;\n    background: rgb(255, 255, 255);\n    margin: 8px 0;\n    font-size: 11px;\n    line-height: 1.4;\n    margin-left: 35px;\n    position: relative;\n    \n    .timestamp {\n      float: right;\n      align-content: end;\n      bottom: -15px;\n      font-size: 9px;\n      z-index: 3;\n      color: rgba(2, 2, 2, 0.3);\n    }\n    \n    &::before {\n      content: '';\n      position: absolute;\n      bottom: -6px;\n      border-top: 6px solid rgb(255, 255, 255);\n      left: 0;\n      border-right: 7px solid transparent;\n    }\n    \n    .avatar {\n      position: absolute;\n      z-index: 1;\n      bottom: -15px;\n      left: -35px;\n      border-radius: 30px;\n      width: 30px;\n      height: 30px;\n      overflow: hidden;\n      margin: 0;\n      padding: 0;\n\n      img {\n        width: 100%;\n        height: 90%;\n      }\n    }\n    \n    &.message-personal {\n      float: right;\n      text-align: right;\n      background: linear-gradient(120deg, #E1F6CA, #E1F6CA);\n      border-radius: 10px 10px 0 10px;\n      \n      &::before {\n        left: auto;\n        right: 0;\n        border-right: none;\n        border-left: 5px solid transparent;\n        border-top: 4px solid #E1F6CA;\n        bottom: -4px;\n      }\n    }\n    \n    &:last-child {\n      margin-bottom: 30px;\n    }\n    \n    &.new {\n      transform: scale(0);\n      transform-origin: 0 0;\n      animation: bounce 500ms linear both;\n    }\n    \n    &.loading {\n\n      &::before {\n        @include ball;\n        border: none;\n        animation-delay: .15s;\n      }\n\n      & span {\n        display: block;\n        font-size: 0;\n        width: 20px;\n        height: 10px;\n        position: relative;\n\n        &::before {\n          @include ball;\n          margin-left: -7px;\n        }\n\n        &::after {\n          @include ball;\n          margin-left: 7px;\n          animation-delay: .3s;\n        }\n      }\n    }\n    \n  }\n}\n\n\n/*--------------------\nMessage Box\n--------------------*/\n.message-box {\n  flex: 0 1 40px;\n  width: 100%;\n  background: #F0F2F5;\n  padding: 10px;\n  position: relative;\n  \n  & .message-input {\n    background: none;\n    border: none;\n    outline: none!important;\n    resize: none;\n    color: rgb(12, 12, 12);\n    font-size: 11px;\n    height: 17px;\n    margin: 0;\n    padding-right: 20px;\n    width: 265px;\n  }\n  \n  textarea:focus:-webkit-placeholder{\n      color: transparent;\n  }\n  \n  & .message-submit {\n    position: absolute;\n    z-index: 1;\n    top: 9px;\n    right: 10px;\n    color: #fff;\n    border: none;\n    background: #248A52;\n    font-size: 10px;\n    text-transform: uppercase;\n    line-height: 1;\n    padding: 6px 10px; \n    border-radius: 10px;\n    outline: none!important;\n    transition: background .2s ease;\n    \n    &:hover {\n      background: #1D7745;\n    }\n  }\n\n  & .message-submit:disabled {\n    position: absolute;\n    z-index: 1;\n    top: 9px;\n    right: 10px;\n    color: #fff;\n    border: none;\n    background: #CCCCCC;\n    font-size: 10px;\n    text-transform: uppercase;\n    line-height: 1;\n    padding: 6px 10px; \n    border-radius: 10px;\n  }\n}\n\n\n/*--------------------\nCustom Srollbar\n--------------------*/\n/* width */\n::-webkit-scrollbar {\n  width: 0.3em;\n  opacity: 0;\n}\n\n/* Track */\n::-webkit-scrollbar-track {\n  box-shadow: inset 0 0 5px #F0F2F5; \n  opacity: 0;\n}\n \n/* Handle */\n::-webkit-scrollbar-thumb {\n  background-color: rgba(192, 185, 185, 0.5)!important;\n  opacity: 0;\n}\n\n/* Handle on hover */\n::-webkit-scrollbar-thumb:hover {\n  background-color: rgba(192, 185, 185, 0.5)!important;\n  margin: 1px -3px 1px 0;\n  opacity: 0;\n}\n\n.mCSB_scrollTools {\n  margin: 1px -3px 1px 0;\n  opacity: 0;\n}\n\n.mCSB_inside > .mCSB_container {\n  margin-right: 0px;\n  padding: 0 10px;\n}\n\n.mCSB_scrollTools .mCSB_dragger .mCSB_dragger_bar {\n  background-color: rgba(192, 185, 185, 0.5)!important;\n}\n\n\n/*--------------------\nBounce\n--------------------*/\n@keyframes bounce { \n  0% { transform: matrix3d(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  4.7% { transform: matrix3d(0.45, 0, 0, 0, 0, 0.45, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  9.41% { transform: matrix3d(0.883, 0, 0, 0, 0, 0.883, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  14.11% { transform: matrix3d(1.141, 0, 0, 0, 0, 1.141, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  18.72% { transform: matrix3d(1.212, 0, 0, 0, 0, 1.212, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  24.32% { transform: matrix3d(1.151, 0, 0, 0, 0, 1.151, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  29.93% { transform: matrix3d(1.048, 0, 0, 0, 0, 1.048, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  35.54% { transform: matrix3d(0.979, 0, 0, 0, 0, 0.979, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  41.04% { transform: matrix3d(0.961, 0, 0, 0, 0, 0.961, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  52.15% { transform: matrix3d(0.991, 0, 0, 0, 0, 0.991, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  63.26% { transform: matrix3d(1.007, 0, 0, 0, 0, 1.007, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  85.49% { transform: matrix3d(0.999, 0, 0, 0, 0, 0.999, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); }\n  100% { transform: matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1); } \n}\n\n\n@keyframes ball { \n  from {\n    transform: translateY(0) scaleY(.8);\n  }\n  to {\n    transform: translateY(-10px);\n  }\n}\n","import { Event, Component, FunctionalComponent, Prop, h, EventEmitter, Listen, State } from '@stencil/core';\nimport AIEnterpriseService from '../../service/ai-enterprise.service';\nimport TranslationUtils from '../../utils/translation';\n\ninterface MessagesProps {\n  messages: Message[];\n}\n\ninterface Message {\n  id?: string;\n  content?: string;\n  date: Date;\n  sender: `AI` | `USER`;\n  loading: boolean;\n}\n\nconst Message: FunctionalComponent<Message> = ({ content, date, sender, loading }) => { \n  const dateFormart = date.getHours() + ':' + date.getMinutes();\n\n  const MessageUser = (message: Message) => {\n    return (\n      <div class=\"message message-personal new\">\n        <div innerHTML={ message.content?.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>') || '' }><span/></div>\n        <div class=\"timestamp\">{dateFormart}</div>\n      </div>\n    )\n  }\n\n  const MessageAI = (message: Message) => {\n    return (\n      <div class={`message ${!message.loading || `loading`} new`}>\n        <figure class=\"avatar\">\n          <img src=\"https://cloudfronttestebucket.s3.amazonaws.com/agent.jpg\" />\n        </figure>\n        <div innerHTML={ message.content?.replace(/(?:\\r\\n|\\r|\\n)/g, '<br>') || '' }><span/></div>\n        <div class=\"timestamp\">{dateFormart}</div>\n      </div>\n    )\n  }\n\n  return sender === `AI` ? \n    MessageAI({ content, date, sender, loading }) : \n    MessageUser({ content, date, sender, loading });\n};\n\nconst Messages: FunctionalComponent<MessagesProps> = ({ messages }) => { \n  return (\n    <div class='messages-content'>\n      { messages.map((message) => (\n        <Message \n          content={message.content} \n          date={message.date} \n          sender={message.sender} \n          loading={message.loading} />\n      ))}\n    </div>\n  )\n};\n\n\nconst service = new AIEnterpriseService({\n  url: 'https://ai-enterprise-api.azurewebsites.net',\n  key: 'my-key',\n});\n\n@Component({\n  tag: 'chat-component',\n  styleUrl: 'chat-component.scss',\n  shadow: true,\n})\nexport class ChatComponent {\n  /**\n   * The greetings\n   */\n  @Prop() greetings: string;\n\n  /**\n   * The Agent identifier\n   */\n  @Prop() identifier: string;\n\n  /**\n   * The Chat identifier\n   */\n  @Prop() chatUid?: string;\n\n  /**\n   * The language\n   */\n  @Prop() language?: string;\n  \n  @Event() send: EventEmitter;\n  @Event() receiver: EventEmitter;\n\n  @State() translations: any;\n  @State() messages: Message[] = [];\n  @State() content: string = '';\n  @State() disableSend: boolean = true;\n\n  async componentWillLoad() {\n    const messageID = Math.random().toString(36).substring(7);\n\n    this.translations = await TranslationUtils.fetchTranslations(this.language);\n\n    this.receiver.emit({\n      id: messageID,\n      content: undefined,\n      date: new Date(),\n      loading: true,\n      sender: 'AI'\n    });\n\n    service.send({ content: this.greetings || 'Hi' }, this.chatUid || '1', this.identifier)\n      .then((response) => {\n        this.receiver.emit({\n          id: messageID,\n          content: response,\n          date: new Date(),\n          loading: false,\n          sender: 'AI'\n        });\n\n        this.disableSend = false;\n      })\n      .catch((error) => {\n        console.error(error);\n      });\n  }\n\n  componentDidRender() {\n    this.onScroll(null);\n  }\n\n  @Listen('send')\n  sendHandler(event: CustomEvent<Message>) {\n    const message = event.detail as any;\n    \n    this.disableSend = true;\n\n    this.receiver.emit({\n      ...message,\n    });\n\n    const messageID = Math.random().toString(36).substring(7);\n\n    this.receiver.emit({\n      id: messageID,\n      date: new Date(),\n      loading: true,\n      sender: 'AI'\n    });\n  \n    service.send(message, this.chatUid || '1', this.identifier)\n      .then((response) => {\n        this.receiver.emit({\n          id: messageID,\n          content: response,\n          date: new Date(),\n          loading: false,\n          sender: 'AI'\n        });\n\n        this.disableSend = false;\n      })\n      .catch((error) => {\n        console.error(error);\n      });\n  }\n\n  @Listen('receiver')\n  receiverHandler(event: CustomEvent<Message>) {\n    const message = event.detail;\n\n    this.messages = [\n      ...this.messages.filter(item => item.id !== message.id), \n      message,\n    ];\n  }\n\n  @Listen('keydown')\n  handleKeyDown(ev: KeyboardEvent){\n    if (ev.key === 'Enter' && !this.disableSend){\n      this.handleSend(ev);\n    }\n  }\n\n  handleSend(event: Event) {\n    event.preventDefault();\n\n    if (!this.content) return;\n\n    this.send.emit({\n      id: Math.random().toString(36).substring(7),\n      content: this.content,\n      date: new Date(),\n      loading: false,\n      sender: 'USER'\n    });\n\n    this.content = '';\n  }\n\n  handleChange(event: Event) { \n    this.content = (event.target as HTMLInputElement).value;    \n  }\n\n  renderMessages = (messages: Message[]) => {\n    return (\n      <Messages messages={messages} />\n    )\n  }\n\n  private messagesContainer: HTMLDivElement = null;\n  \n  onScroll(_e) {\n    if (this.messagesContainer) {\n      this.messagesContainer.scrollTo({\n        top: this.messagesContainer.scrollHeight,\n        behavior: 'smooth'\n      });\n    }\n  }\n\n  render() {\n    return (\n      <div>\n      <div class='chat'>\n        <div class='chat-title'>\n          <h1>GSP Ada</h1>\n          <h2>BOT Global Sales Plataform</h2>\n          <figure class='avatar'>\n            <img src='https://cloudfronttestebucket.s3.amazonaws.com/agent.jpg' />\n          </figure>\n        </div>\n        <div class='messages' ref={ el => this.messagesContainer = el }>\n          { this.renderMessages(this.messages) }\n        </div>\n        <div class='message-box'>\n          <textarea\n            typeof='text'\n            value={ this.content }\n            onInput={ (event) => this.handleChange(event) } \n            class='message-input' \n            placeholder={ this.translations['text.placeholder'] }>\n          </textarea>\n          <button disabled={this.disableSend} type='submit' class='message-submit' onClick={ (e) => this.handleSend(e) }>\n            { this.translations['button.send'] }\n          </button>\n        </div>\n      </div> \n      <div class=\"bg\"></div>\n      </div>\n    )\n  }\n}\n"],"mappings":"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"}